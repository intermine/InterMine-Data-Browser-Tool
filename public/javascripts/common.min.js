function initializeStartupConfiguration(){window.imTableConstraint={goAnnotation:[],datasetName:[],pathwayName:[],proteinDomainName:[],diseaseName:[]},window.interminesHashMap=null,window.locationFilter=null,window.interactionsFilter=null,window.clinVarFilter=null,window.expressionFilter=null,window.proteinLocalisationFilter=null,window.currentClassViewFilter=null,window.pieChartObject=null,window.geneLengthChartObject=null,window.minesConfigs=null,readTextFile("./mine_configs/mines_config.json",function(e){window.minesConfigs=JSON.parse(e)}),window.mineUrl="httpCOLONSLASHSLASHwww.humanmine.orgSLASHhumanmineSLASHservice",window.selectedMineName="HumanMine",sessionStorage.getItem("currentClassView")||sessionStorage.setItem("currentClassView","Gene"),"undefined"!=typeof Storage&&localStorage.getItem("selectedMineName")&&localStorage.getItem("mineUrl")&&(window.mineUrl=localStorage.getItem("mineUrl"),window.selectedMineName=localStorage.getItem("selectedMineName")),$("#apiKeyManagerButton").click(function(){initializeKeyManager(),$("#apiKeyManagerModal").appendTo("body").modal("show")}),$("#apiKeyManagerSaveButton").click(function(){var n=[],a=!1;$("#apiKeyManagerModalKeysDiv").children("div").each(function(){var t=$(this).children("label").text(),i=$(this).children("input").val();""!=i?$.ajax({url:findElementJSONarray(window.interminesHashMap,"mine",t).mineurl+"/user/whoami?token="+i,type:"GET",async:!1,success:function(e){n.push({mine:t,apikey:i})},error:function(e){a=!0,0==$("#invalidAPIkeyAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='invalidAPIkeyAlert'><span class='closebtn' id='closeInvalidAPIkeyAlert'>×</span>Error: API key provided for "+t+" is not a valid API key - please check you have entered it correctly.</div><br/>"),$("#closeInvalidAPIkeyAlert").click(function(){$("#invalidAPIkeyAlert").hide()})):$("#invalidAPIkeyAlert").show()}.bind(this,a)}):n.push({mine:t,apikey:i})}).promise().done(function(){a||(localStorage.setItem("api-keys",JSON.stringify(n)),location.reload()),$("#apiKeyManagerModal").modal("toggle")})}),$("#viewManagerButton").click(function(){initializeViewManager(),$("#viewManagerModal").appendTo("body").modal("show")})}function updateTableWithConstraints(){for(;0<window.imTable.query.constraints.length;)try{window.imTable.query.removeConstraint(window.imTable.query.constraints[0])}catch(e){continue}if(0<window.imTableConstraint.goAnnotation.length&&("Gene"==sessionStorage.getItem("currentClassView")?window.imTable.query.addConstraint({path:"goAnnotation.ontologyTerm.name",op:"ONE OF",values:window.imTableConstraint.goAnnotation}):window.imTable.query.addConstraint({path:"ontologyAnnotations.ontologyTerm.name",op:"ONE OF",values:window.imTableConstraint.goAnnotation})),0<window.imTableConstraint.datasetName.length&&window.imTable.query.addConstraint({path:"dataSets.name",op:"ONE OF",values:window.imTableConstraint.datasetName}),0<window.imTableConstraint.pathwayName.length&&window.imTable.query.addConstraint({path:"pathways.name",op:"ONE OF",values:window.imTableConstraint.pathwayName}),0<window.imTableConstraint.proteinDomainName.length){var e=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"Protein-Domain"===e.filterName})[0].filterQuery[0];e.values=window.imTableConstraint.proteinDomainName,"Gene"==sessionStorage.getItem("currentClassView")&&window.imTable.query.addConstraint(e)}if(0<window.imTableConstraint.diseaseName.length){var t=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"Diseases"===e.filterName})[0].filterQuery[0];t.values=window.imTableConstraint.diseaseName,window.imTable.query.addConstraint(t)}}function showMoreDatasetNames(){$.when(getDatasetNamesInClass()).done(function(e){for(var t=[],i=0;i<e.results.length;i++)if(null!=e.results[i].item){if("KEGG pathways data set"==e.results[i].item||"HGNC identifiers"==e.results[i].item||"BioGRID interaction data set"==e.results[i].item||"IntAct interactions data set"==e.results[i].item||"ClinVar data set"==e.results[i].item||"OMIM diseases"==e.results[i].item)continue;t.push({label:e.results[i].item+" ("+e.results[i].count+")",value:e.results[i].item})}var n=[];for(i=0;i<t.length;i++)n.push(t[i].value);if(n.sort(),!(n.length<4)){var a=(n=n.slice(3)).length;for(i=0;i<a;i++){var l=n[i];$("#datasetsSelector").append('<div class="form-check" style="margin-left: 10px;"><input class="form-check-input" type="checkbox" id="'+l.replace(/[^a-zA-Z0-9]/g,"")+'" value="'+l+'"><label class="form-check-label" for="'+l+'"><p>'+l+"</p></label></div>"),$("#"+l.replace(/[^a-zA-Z0-9]/g,"")).change(function(){if($(this).is(":checked")){var e=$(this).val();window.imTableConstraint.datasetName.push(e)}else{e=$(this).val();remove(window.imTableConstraint.datasetName,e)}updateTableWithConstraints()})}}})}function clearCustomFilters(){$("#locationFilterLi").remove(),$("#diseasesFilterLi").remove(),$("#clinvarFilterLi").remove(),$("#proteinLocalisationFilterLi").remove(),$("#proteinDomainFilterLi").remove(),$("#interactionsFilterLi").remove(),$("#expressionFilterLi").remove(),$("#datasetFilterLi").remove(),window.CustomFiltersAdded=!1}function addCustomFilters(){if(!window.CustomFiltersAdded)if("Gene"==sessionStorage.getItem("currentClassView")){var e=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters;0<e.filter(function(e){return"Location"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Location" id="locationFilterLi"><a class="nav-link" data-toggle="collapse" href="#locationSearchCardBlock" aria-controls="locationSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-location-arrow"></i><span class="nav-link-text"></span>Location</a>    <div class="card" style="width: 100%;">        <div class="collapse card-block" id="locationSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;">            <div class="ul list-group list-group-flush" id="locationFilterList"></div>            <form-group class="ui-front">                <div class="row" style="align: center;"><input class="form-control" type="text" id="locationChromosomeSearchInput" placeholder="Chromosome (e.g. 12)" style="width: 100%; float:left; margin-left: 15px;" /></div>                <div class="row" style="align: center;"><input class="form-control" type="text" id="locationStartSearchInput" placeholder="Start" style="width: 45%; float:left; margin-left: 15px;" /><input class="form-control" type="text" id="locationEndSearchInput" placeholder="End" style="width: 45%;"                    /></div><button class="btn btn-success" type="button" style="width:100%;" id="locationSearchButton">Go!</button><button class="btn btn-secondary" type="button" style="width:100%;" id="locationResetButton">Reset</button></form-group>        </div>    </div></li>'),$("#locationSearchButton").click(function(){showPreloader(),window.locationFilter&&clearLocationConstraint();var e=$("#locationChromosomeSearchInput").val(),t=$("#locationStartSearchInput").val(),i=$("#locationEndSearchInput").val();if(e||(0==$("#locationFilterAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='locationFilterAlert'><span class='closebtn' id='closeLocationFilterAlert'>×</span>Please, specify a chromosome in the filter input field.</div><br/>"),$("#closeLocationFilterAlert").click(function(){$("#locationFilterAlert").hide()})):$("#locationFilterAlert").show()),$.isNumeric(t)&&$.isNumeric(i))if(parseInt(t)>parseInt(i))0==$("#locationFilterAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='locationFilterAlert'><span class='closebtn' id='closeLocationFilterAlert'>×</span>The location start position must be less or equal to the end position.</div><br/>"),$("#closeLocationFilterAlert").click(function(){$("#locationFilterAlert").hide()})):$("#locationFilterAlert").show();else{window.locationFilter=[];var n=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"Location"===e.filterName}),a=n[0].filterQuery[0];a.value=parseInt(t);var l=n[0].filterQuery[1];l.value=parseInt(i);var o=n[0].filterQuery[2];o.value=parseInt(e),window.imTable.query.addConstraint(a),window.locationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]),window.imTable.query.addConstraint(l),window.locationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]),window.imTable.query.addConstraint(o),window.locationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])}else 0==$("#locationFilterAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='locationFilterAlert'><span class='closebtn' id='closeLocationFilterAlert'>×</span>Please, write a integer number in both the 'Start' and 'End' input fields.</div><br/>"),$("#closeLocationFilterAlert").click(function(){$("#locationFilterAlert").hide()})):$("#locationFilterAlert").show()}),$("#locationResetButton").click(function(){window.locationFilter&&clearLocationConstraint(),$("#locationStartSearchInput").val(""),$("#locationEndSearchInput").val(""),$("#locationChromosomeSearchInput").val("")})),0<e.filter(function(e){return"Expression"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Expression" id="expressionFilterLi"><a class="nav-link" data-toggle="collapse" href="#expressionSearchCardBlock" aria-controls="expressionSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-tasks"></i><span class="nav-link-text"></span>Expression</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="expressionSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><div class="ul list-group list-group-flush" id="expressionFilterList"></div><form-group class="ui-front"><div class="row" style="align: center;"><select class="form-control" id="expressionExpressionSelector" style="width: 45%; float:left; margin-left: 15px;"><option value="UP">UP</option><option value="DOWN">DOWN</option><option value="NONDE">NONDE</option></select><select class="form-control" id="expressionDatasetSelector" style="width: 45%;"><option value="All">All (Set)</option><option value="ArrayExpress accession: E-MTAB-62">E-MTAB-62</option><option value="E-MTAB-513 illumina body map">Illumina bodymap</option></select></div><div class="row" style="align: center;"><input class="form-control" type="text" id="expressionPvalueSearchInput" placeholder="P-value (Opt)" style="width: 45%; float:left; margin-left: 15px;"/><input class="form-control" type="text" id="expressionTstatisticSearchInput" placeholder="T-statistic (Opt)" style="width: 45%;"/></div><button class="btn btn-success" type="button" style="width:100%;" id="expressionSearchButton">Go!</button><button class="btn btn-secondary" type="button" style="width:100%;" id="expressionResetButton">Reset</button></form-group></div></div></li>'),$("#expressionSearchButton").click(function(){showPreloader(),window.expressionFilter&&clearExpressionFilterConstraint();var e=$("#expressionPvalueSearchInput").val(),t=$("#expressionTstatisticSearchInput").val(),i=$("#expressionExpressionSelector").val(),n=$("#expressionDatasetSelector").val();window.expressionFilter=[];var a=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"Expression"===e.filterName}),l=a[0].filterQuery[0];l.value=e;var o=a[0].filterQuery[1];o.value=t;var s=a[0].filterQuery[2];s.value=i;var r=a[0].filterQuery[3];r.value=n,e&&(window.imTable.query.addConstraint(l),window.expressionFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),t&&(window.imTable.query.addConstraint(o),window.expressionFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),window.imTable.query.addConstraint(s),window.expressionFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]),"All"!=n&&(window.imTable.query.addConstraint(r),window.expressionFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]))}),$("#expressionResetButton").click(function(){window.expressionFilter&&clearExpressionFilterConstraint(),$("#expressionTstatisticSearchInput").val(""),$("#expressionPvalueSearchInput").val("")})),0<e.filter(function(e){return"Interactions"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Interactions" id="interactionsFilterLi"><a class="nav-link" data-toggle="collapse" href="#interactionsSearchCardBlock" aria-controls="interactionsSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-podcast"></i><span class="nav-link-text"></span>Interactions</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="interactionsSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><div class="ul list-group list-group-flush" id="interactionsFilterList"></div><form-group class="ui-front"><div class="row" style="align: center;"><input class="form-control" type="text" id="interactionsParticipant2SearchInput" placeholder="Optional: Participant 2 (symbol)" style="width: 100%; float:left; margin-left: 15px;"/></div><div class="row" style="align: center;"><select class="form-control" id="interactionsTypeSelector" style="width: 45%; float:left; margin-left: 15px;"><option value="All">All (Type)</option><option value="physical">Physical</option><option value="genetic">Genetic</option></select><select class="form-control" id="interactionsDatasetSelector" style="width: 45%;"><option value="All">All (Set)</option><option value="BioGRID interaction data set">BioGRID</option><option value="IntAct interactions data set">IntAct</option></select></div><button class="btn btn-success" type="button" style="width:100%;" id="interactionsSearchButton">Go!</button><button class="btn btn-secondary" type="button" style="width:100%;" id="interactionsResetButton">Reset</button></form-group></div></div></li>'),$.when(getParticipant2SymbolsInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#interactionsParticipant2SearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#interactionsParticipant2SearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#interactionsParticipant2SearchInput").val(t.item.value)}})}),$("#interactionsSearchButton").click(function(){showPreloader(),window.interactionsFilter&&clearInteractionsConstraint();var e=$("#interactionsParticipant2SearchInput").val(),t=$("#interactionsTypeSelector").val(),i=$("#interactionsDatasetSelector").val();window.interactionsFilter=[];var n=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"Interactions"===e.filterName}),a=n[0].filterQuery[0];a.value=e;var l=n[0].filterQuery[1];l.value=t;var o=n[0].filterQuery[2];o.value=i,e&&(window.imTable.query.addConstraint(a),window.interactionsFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),"All"!=t&&(window.imTable.query.addConstraint(l),window.interactionsFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),"All"!=i&&(window.imTable.query.addConstraint(o),window.interactionsFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]))}),$("#interactionsResetButton").click(function(){window.interactionsFilter&&clearInteractionsConstraint(),$("#interactionsParticipant2SearchInput").val("")})),0<e.filter(function(e){return"Diseases"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Diseases (OMIM)" id="diseasesFilterLi"><a class="nav-link" data-toggle="collapse" href="#diseasesSearchCardBlock" aria-controls="diseasesSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-certificate"></i><span class="nav-link-text"></span>Diseases (OMIM)</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="diseasesSearchCardBlock" style="overflow: auto;"><div class="ul list-group list-group-flush" id="diseasesFilterList"></div><form-group class="ui-front"><input class="form-control" type="text" id="diseasesSearchInput" placeholder="e.g. alzheimer disease"/></form-group></div></div></li>'),$.when(getDiseasesNamesInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#diseasesSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#diseasesSearchInput").val(t.item.value),window.imTableConstraint.diseaseName.push(t.item.value),updateTableWithConstraints();var i=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#diseasesFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+i+'" style="height: 100%;">x</button></span></div>'),$("#"+i).click(function(){remove(window.imTableConstraint.diseaseName,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#diseasesSearchInput").val(t.item.value)}})})),0<e.filter(function(e){return"CLINVAR"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="ClinVar" id="clinvarFilterLi"><a class="nav-link" data-toggle="collapse" href="#clinvarSearchCardBlock" aria-controls="clinvarSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-eyedropper"></i><span class="nav-link-text"></span>ClinVar</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="clinvarSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><form-group class="ui-front"><div style="align: center;"><input class="form-control" type="text" id="clinvarClinicalSignificanceSearchInput" placeholder="Significance (e.g. Pathogenic)" style="width: 100%;"/><input class="form-control" type="text" id="clinvarTypeSearchInput" placeholder="Type (e.g. insertion)" style="width: 100%;"/></div><button class="btn btn-success" type="button" style="width:100%;" id="clinvarSearchButton">Go!</button><button class="btn btn-secondary" type="button" style="width:100%;" id="clinvarResetButton">Reset</button></form-group></div></div></li>'),$.when(getAllelesClinicalSignifanceInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#clinvarClinicalSignificanceSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#clinvarClinicalSignificanceSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#clinvarClinicalSignificanceSearchInput").val(t.item.value)}})}),$.when(getAllelesTypesInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#clinvarTypeSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#clinvarTypeSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#clinvarTypeSearchInput").val(t.item.value)}})}),$("#clinvarSearchButton").click(function(){showPreloader(),window.clinVarFilter&&clearClinVarConstraint();var e=$("#clinvarClinicalSignificanceSearchInput").val(),t=$("#clinvarTypeSearchInput").val();if(e&&t){window.clinVarFilter=[];var i=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"CLINVAR"===e.filterName}),n=i[0].filterQuery[0];n.value=t;var a=i[0].filterQuery[1];a=e,window.imTable.query.addConstraint(n),window.clinVarFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]),window.imTable.query.addConstraint(a),window.clinVarFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])}else 0==$("#clinvarFilterAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='clinvarFilterAlert'><span class='closebtn' id='closeClinVarFilterAlert'>×</span>Please, specify a clinical significante and type in the filter input field.</div><br/>"),$("#closeClinVarFilterAlert").click(function(){$("#clinvarFilterAlert").hide()})):$("#clinvarFilterAlert").show()}),$("#clinvarResetButton").click(function(){window.clinVarFilter&&clearClinVarConstraint(),$("#clinvarClinicalSignificanceSearchInput").val(""),$("#clinvarTypeSearchInput").val("")})),0<e.filter(function(e){return"Protein-Localisation"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Protein Localisation" id="proteinLocalisationFilterLi"><a class="nav-link" data-toggle="collapse" href="#proteinLocalisationSearchCardBlock" aria-controls="proteinLocalisationSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-trello"></i><span class="nav-link-text"></span>Protein Localisation</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="proteinLocalisationSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;"><div class="ul list-group list-group-flush" id="proteinLocalisationFilterList"></div><form-group class="ui-front"><div class="row"><input class="form-control" type="text" id="proteinLocalisationCellTypeSearchInput" placeholder="Cell type (e.g. adipocytes)" style="width: 100%; margin-left: 15px;"/></div><div class="row" style="align: center;"><select class="form-control" id="proteinLocalisationExpressionTypeSelector" style="width: 45%; float:left; margin-left: 15px;"><option value="All">All (Type)</option><option value="APE - two or more antibodies">Two or more antibodies</option><option value="Staining - one antibody only">One antibody only</option></select><select class="form-control" id="proteinLocalisationLevelSelector" style="width: 45%;"><option value="All">All (Level)</option><option value="Low">Low</option><option value="Medium">Medium</option><option value="High">High</option><option value="Not detected">Not detected</option></select></div><div class="row" style="align: center;"><input class="form-control" type="text" id="proteinLocalisationTissueSearchInput" placeholder="Tissue" style="width: 45%; float:left; margin-left: 15px;"/><select class="form-control" id="proteinLocalisationRealibilitySelector" style="width: 45%;"><option value="All">All (Realibility)</option><option value="Low">Low</option><option value="Uncertain">Uncertain</option><option value="Supportive">Supportive</option><option value="High">High</option></select></div><button class="btn btn-success" type="button" style="width:100%;" id="proteinLocalisationSearchButton">Go!</button><button class="btn btn-secondary" type="button" style="width:100%;" id="proteinLocalisationResetButton">Reset</button></form-group></div></div></li>'),$.when(getProteinAtlasExpressionCellTypesInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinLocalisationCellTypeSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinLocalisationCellTypeSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#proteinLocalisationCellTypeSearchInput").val(t.item.value)}})}),$.when(getProteinAtlasExpressionTissueNamesInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinLocalisationTissueSearchInput").autocomplete({minLength:2,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinLocalisationTissueSearchInput").val(t.item.value)},focus:function(e,t){e.preventDefault(),$("#proteinLocalisationTissueSearchInput").val(t.item.value)}})}),$("#proteinLocalisationSearchButton").click(function(){showPreloader(),window.proteinLocalisationFilter&&clearProteinLocalisationFilterConstraint();var e=$("#proteinLocalisationCellTypeSearchInput").val(),t=$("#proteinLocalisationExpressionTypeSelector").val(),i=$("#proteinLocalisationLevelSelector").val(),n=$("#proteinLocalisationTissueSearchInput").val(),a=$("#proteinLocalisationRealibilitySelector").val();window.proteinLocalisationFilter=[];var l=window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName})[0].customFilters.filter(function(e){return"Protein-Localisation"===e.filterName}),o=l[0].filterQuery[0];o.value=e;var s=l[0].filterQuery[1];s.value=n;var r=l[0].filterQuery[2];r.value=t;var c=l[0].filterQuery[3];c.value=i;var u=l[0].filterQuery[4];u.value=a,e&&(window.imTable.query.addConstraint(o),window.proteinLocalisationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),n&&(window.imTable.query.addConstraint(s),window.proteinLocalisationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),"All"!=t&&(window.imTable.query.addConstraint(r),window.proteinLocalisationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),"All"!=i&&(window.imTable.query.addConstraint(c),window.proteinLocalisationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1])),"All"!=a&&(window.imTable.query.addConstraint(u),window.proteinLocalisationFilter.push(window.imTable.query.constraints[window.imTable.query.constraints.length-1]))}),$("#proteinLocalisationResetButton").click(function(){window.proteinLocalisationFilter&&clearProteinLocalisationFilterConstraint(),$("#proteinLocalisationCellTypeSearchInput").val(""),$("#proteinLocalisationTissueSearchInput").val("")})),0<e.filter(function(e){return"Protein-Domain"===e.filterName}).length&&($("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Protein Domain Name" id="proteinDomainFilterLi"><a class="nav-link" data-toggle="collapse" href="#proteinDomainNameSearchCardBlock" aria-controls="proteinDomainNameSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-product-hunt"></i><span class="nav-link-text"></span>Protein Domain Name</a><div class="card" style="width: 100%;"><div class="collapse card-block" id="proteinDomainNameSearchCardBlock" style="overflow: auto;"><div class="ul list-group list-group-flush" id="proteinDomainNameFilterList"></div><form-group class="ui-front"><input class="form-control" type="text" id="proteinDomainNameSearchInput" placeholder="e.g. immunoglobulin subtype"/></form-group></div></div></li>'),$.when(getProteinDomainNamesInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#proteinDomainNameSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#proteinDomainNameSearchInput").val(t.item.value),window.imTableConstraint.proteinDomainName.push(t.item.value),updateTableWithConstraints();var i=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#proteinDomainNameFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+i+'" style="height: 100%;">x</button></span></div>'),$("#"+i).click(function(){remove(window.imTableConstraint.proteinDomainName,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#proteinDomainNameSearchInput").val(t.item.value)}})})),createDatasetFilter(),window.CustomFiltersAdded=!0}else createDatasetFilter()}function displayItemsInClass(e){$("#organismshortnamelist").parent().find("li").remove();for(var t=[],i=[],n=getColorsArray(e[0].response.results.length),a=0;a<e[0].response.results.length;a++)t.push(e[0].response.results[a].count),i.push(e[0].response.results[a].item);var l=e[0].response.results.length;5<l&&(l=5);for(a=0;a<l;a++){var o=e[0].response.results[a].item,s="("+e[0].response.results[a].count+")";$("#organismshortnamelist").append('<li class="list-group-item" style="border-width: 2px; border-style: solid; border-color: '+n[a]+';"><a class="nav-link" href="#" style="color:black; text-align:center;"><p class="float-md-left">'+o+'</p><p class="float-md-right">'+s+"</p></a></li>")}}function updatePieChart(e,t){window.pieChartObject&&window.pieChartObject.destroy();for(var i=document.getElementById(t),n=[],a=[],l=getColorsArray(e[0].response.results.length),o=0;o<e[0].response.results.length;o++)n.push(e[0].response.results[o].count),a.push(e[0].response.results[o].item+" ("+e[0].response.results[o].count+")");var s={responsive:!0,maintainAspectRatio:!1,elements:{center:{text:"90%",color:"#FF6384",fontStyle:"Arial",sidePadding:20}},legend:{display:!0,position:"top",onClick:function(e){e.stopPropagation()}},hover:{mode:"nearest",intersect:!0},title:{display:!0,text:"Number of results for "+sessionStorage.getItem("currentClassView")+" by organism",position:"bottom"},tooltips:{callbacks:{label:function(e,t){return t.labels[e.index]}},custom:function(e){e.opacity||(document.getElementById(t).style.cursor="default")}},onClick:function(e,t){if(t.length){var i=t[0]._index;selectedSegment=window.pieChartObject.data.labels[i].split("(")[0].trim(),window.imTable.query.addConstraint({path:"organism.shortName",op:"==",value:selectedSegment})}}};window.pieChartObject=new Chart(i,{type:"pie",data:{labels:a,datasets:[{data:n,backgroundColor:l}]},options:s})}function createGoAnnotationFilter(){try{$.when(getOntologyTermsInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#goAnnotationSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},updater:function(e){return e},select:function(e,t){e.preventDefault(),$("#goAnnotationSearchInput").val(t.item.value),window.imTableConstraint.goAnnotation.push(t.item.value),updateTableWithConstraints();var i=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#goAnnotationFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+i+'" style="height: 100%;">x</button></span></div>'),$("#"+i).click(function(){remove(window.imTableConstraint.goAnnotation,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#goAnnotationSearchInput").val(t.item.value)}})})}catch(e){$("#goAnnotationFilterLi").remove(),console.log(e)}}function createDatasetFilter(){try{0==$("#datasetFilterLi").length&&$("#sidebarUl").append('<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Dataset Name" id="datasetFilterLi"><a class="nav-link" data-toggle="collapse" href="#datasetNameSearchCardBlock" aria-controls="datasetNameSearchCardBlock" style="color:black;"><i class="fa fa-fw fa-database"></i><span class="nav-link-text"></span>Dataset Name</a><div class="card" style="width: 100%;">        <div class="collapse card-block" id="datasetNameSearchCardBlock" style="overflow-y: auto; overflow-x:hidden;">            <form-group class="ui-front">                <div id="datasetsSelector"></div>            </form-group><button class="btn btn-block btn-warning" id="btnDatasetViewMore" type="button">View more</button></div>    </div></li>'),$.when(getDatasetNamesInClass()).done(function(e){if(!window.datasetNamesLoaded){for(var t=[],i=0;i<e.results.length;i++)if(null!=e.results[i].item){if("KEGG pathways data set"==e.results[i].item||"HGNC identifiers"==e.results[i].item||"BioGRID interaction data set"==e.results[i].item||"IntAct interactions data set"==e.results[i].item||"ClinVar data set"==e.results[i].item||"OMIM diseases"==e.results[i].item)continue;t.push({label:e.results[i].item+" ("+e.results[i].count+")",value:e.results[i].item})}$("#datasetsSelector").empty();var n=e.results.length,a=[];for(i=0;i<t.length;i++)a.push(t[i].value);a.sort(),3<n&&(n=3);for(i=0;i<n;i++){var l=a[i];$("#datasetsSelector").append('<div class="form-check" style="margin-left: 10px;"><input class="form-check-input" type="checkbox" id="'+l.replace(/[^a-zA-Z0-9]/g,"")+'" value="'+l+'"><label class="form-check-label" for="'+l+'"><p>'+l+"</p></label></div>"),$("#"+l.replace(/[^a-zA-Z0-9]/g,"")).change(function(){if($(this).is(":checked")){var e=$(this).val();window.imTableConstraint.datasetName.push(e)}else{e=$(this).val();remove(window.imTableConstraint.datasetName,e)}updateTableWithConstraints()})}window.datasetNamesLoaded=!0}})}catch(e){$("#datasetFilterLi").remove(),console.log(e)}}function createPathwaysNameFilter(){try{$.when(getPathwayNamesInClass()).done(function(e){for(var i=[],t=0;t<e.results.length;t++)null!=e.results[t].item&&i.push({label:e.results[t].item+" ("+e.results[t].count+")",value:e.results[t].item});$("#pathwayNameSearchInput").autocomplete({minLength:3,source:function(e,t){t($.ui.autocomplete.filter(i,e.term).slice(0,15))},select:function(e,t){e.preventDefault(),$("#pathwayNameSearchInput").val(t.item.value),window.imTableConstraint.pathwayName.push(t.item.value),updateTableWithConstraints();var i=t.item.value.replace(/[^a-zA-Z0-9]/g,"")+"button";$("#pathwayFilterList").append('<div class="input-group" id="'+t.item.value.replace(/[^a-zA-Z0-9]/g,"")+'"><label class="form-control">'+t.item.value.slice(0,22)+'</label><span class="input-group-btn"><button class="btn btn-sm" type="button" id="'+i+'" style="height: 100%;">x</button></span></div>'),$("#"+i).click(function(){remove(window.imTableConstraint.pathwayName,t.item.value),updateTableWithConstraints(),$("#"+t.item.value.replace(/[^a-zA-Z0-9]/g,"")).remove()})},focus:function(e,t){e.preventDefault(),$("#pathwayNameSearchInput").val(t.item.value)}})})}catch(e){$("#pathwayNameFilterLi").remove(),console.log(e)}}function addDefaultFilters(){createPathwaysNameFilter(),createGoAnnotationFilter()}function fillMineSelector(){if(0==$("#mineSelector option").length){var l=new URL(window.location.href);$.when(getIntermines()).done(function(e){for(var t,i,n=0;n<e.instances.length;n++)if(!e.instances[n].url.startsWith("https")&&"GrapeMine"!=e.instances[n].name&&"RepetDB"!=e.instances[n].name&&"Wheat3BMine"!=e.instances[n].name&&"WormMine"!=e.instances[n].name&&"XenMine"!=e.instances[n].name&&"PlanMine"!=e.instances[n].name&&"ModMine"!=e.instances[n].name&&"MitoMiner"!=e.instances[n].name){var a=e.instances[n].url;"/"==a[a.length-1]?a+="service":a+="/service",a=formatMineURL(a),e.instances[n].name===window.selectedMineName?(t=e.instances[n].name,i=a):$("#mineSelector").append('<option value="'+a+'">'+e.instances[n].name+"</option>").val(a),l.searchParams.get("givenMine")&&e.instances[n].name==l.searchParams.get("givenMine")&&(window.mineUrl=a,window.selectedMineName=e.instances[n].name,sessionStorage.setItem("currentClassView","Gene"),clearCustomFilters(),updateElements(window.imTable.history.currentQuery.constraints,"PieChart"),updateGeneLengthChart(window.imTable.history.currentQuery.constraints,"GeneLengthChart"))}$("#mineSelector").append('<option value="'+i+'">'+t+"</option>").val(a),$("#mineSelector option[value='"+i+"']").attr("selected","selected"),$("#mineSelector").change(function(i){if(!i.eventPhase)return!1;var n=!0,a=$("#mineSelector option:selected").text(),e=$(this).val();$.ajax({url:escapeMineURL(e),data:{},async:!1,error:function(e,t){if(500<=e.status&&e.status<=511||400<=e.status&&e.status<=431)return 0==$("#unavailableMineAlert").length?($("#navbarResponsive").prepend("<div class='alert' id='unavailableMineAlert'><span class='closebtn' id='closeUnavailableMineAlert'>×</span>Sorry, it looks like the "+a+" server is having problems right now. You can try coming back later, or try browsing a different mine using the mine selector in the top-left corner.</div><br/>"),$("#closeUnavailableMineAlert").click(function(){$("#unavailableMineAlert").hide()})):$("#unavailableMineAlert").show(),n=!1,i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),!1}}),n&&(window.mineUrl=e,window.selectedMineName=a,sessionStorage.setItem("currentClassView","Gene"),window.datasetNamesLoaded=!1,window.CustomFiltersAdded=!1,"undefined"!=typeof Storage&&(localStorage.setItem("mineUrl",window.mineUrl),localStorage.setItem("selectedMineName",window.selectedMineName)),location.reload())}),$("#mineSelector").trigger("change")})}}function handleCustomFilters(){window.CustomFiltersAdded||(0<window.minesConfigs.filter(function(e){return e.mineName===window.selectedMineName}).length?(addCustomFilters(),window.CustomFiltersAdded=!0):createDatasetFilter())}function updateElements(e,t){fillMineSelector(),addDefaultFilters(),handleCustomFilters(),initializeKeyManager(),initializeViewManager(),$.when(getItemsInClass(e)).done(function(e){displayItemsInClass(e),createSidebarEvents(),updatePieChart(e,t)})}function initializeKeyManager(){"undefined"!=typeof Storage&&(window.interminesHashMap=[],$.when(getIntermines()).done(function(e){for(var t=0;t<e.instances.length;t++)if(!e.instances[t].url.startsWith("https")&&"GrapeMine"!=e.instances[t].name&&"RepetDB"!=e.instances[t].name&&"Wheat3BMine"!=e.instances[t].name&&"WormMine"!=e.instances[t].name&&"XenMine"!=e.instances[t].name&&"PlanMine"!=e.instances[t].name&&"ModMine"!=e.instances[t].name&&"MitoMiner"!=e.instances[t].name){var i=e.instances[t].name,n=e.instances[t].url;"/"==n[n.length-1]?n+="service":n+="/service",window.interminesHashMap.push({mine:i,mineurl:n,apikey:"Paste your API key here"})}if(localStorage.getItem("api-keys")){var a=JSON.parse(localStorage.getItem("api-keys"));for(t=0;t<window.interminesHashMap.length;t++)findElementJSONarray(a,"mine",window.interminesHashMap[t].mine)||a.push({mine:window.interminesHashMap[t].mine,apikey:"Paste your API key here"});localStorage.setItem("api-keys",JSON.stringify(a))}else localStorage.setItem("api-keys",JSON.stringify(window.interminesHashMap));$("#apiKeyManagerModalKeysDiv").html("");var l=JSON.parse(localStorage.getItem("api-keys"));for(t=0;t<l.length;t++){var o='<div class="apiKeyElement"><label>'+l[t].mine+"</label>";"Paste your API key here"!=l[t].apikey&&""!=l[t].apikey?o+='<input type="text" value="'+l[t].apikey+'"></div>':o+='<input type="text" placeholder="Paste your API key here"></div>',$("#apiKeyManagerModalKeysDiv").append(o)}}))}function initializeViewManager(){if("undefined"!=typeof Storage){var i,n;if(localStorage.getItem("view-manager")||localStorage.setItem("view-manager","[]"),i=JSON.parse(localStorage.getItem("view-manager")),$("#viewManagerModalCurrentViewsDiv").html(""),findElementJSONarray(i,"mine",window.selectedMineName))if((n=findElementJSONarray(i,"mine",window.selectedMineName)).viewNames)for(var e=n.viewNames.split(","),t=0;t<e.length;t++){var a='<div class="viewManagerElement" id="viewManager'+e[t]+'Div"><label id="viewManager'+e[t]+'Label">'+e[t]+"</label>";a+='<button class="btn btn-secondary" type="button" id="viewManager'+e[t]+'RemoveButton" data-dismiss="modal">Remove</button></div>',$("#viewManagerModalCurrentViewsDiv").append(a),$("#viewManager"+e[t]+"RemoveButton").click(function(){var e=$(this).closest("div").find("label").text(),t=findElementJSONarray(JSON.parse(localStorage.getItem("view-manager")),"mine",window.selectedMineName),i=t.viewNames.split(",");remove(i,e),i=i.join(","),t.viewNames=i,localStorage.setItem("view-manager",JSON.stringify([t])),$("#viewManager"+e+"Div").remove(),$("#"+e+"Button").remove(),""===t.viewNames.split(",")[0]&&$("#viewManagerModalCurrentViewsDiv").html("You have not added any custom view for this mine.")})}else $("#viewManagerModalCurrentViewsDiv").html("You have not added any custom view for this mine.");else $("#viewManagerModalCurrentViewsDiv").html("You have not added any custom view for this mine.");$("#viewManagerAddViewButton").click(function(){var e=$("#viewManagerAddViewInput").val();(n=findElementJSONarray(i,"mine",window.selectedMineName))||(i.push({mine:window.selectedMineName,viewNames:""}),n=findElementJSONarray(i,"mine",window.selectedMineName));var t=n.viewNames.split(",");"Gene"==e||"Protein"==e||t.includes(e)||(t.push(e),""===t[0]?n.viewNames=t[1]:n.viewNames=t.join(","),localStorage.setItem("view-manager",JSON.stringify([n])),location.reload())})}}function updateGeneLengthChart(e,g){$.when(getGeneLengthsInClass(e)).done(function(e){window.geneLengthChartObject&&window.geneLengthChartObject.destroy();var t=document.getElementById(g),i=[],n=[],a=[],l=Array(e.results.length).fill("#337ab7");try{for(var o=e.uniqueValues,s=e.results[0].min,r=e.results[0].max,c=parseFloat(e.results[0].average).toFixed(3),u=(r-s)/e.results[0].buckets,d=parseFloat(e.results[0].stdev).toFixed(3),p="Distribution of "+o+" Gene Lengths",m="Min: "+s+". Max: "+r+". Avg: "+c+". Stdev: "+d,w=0;w<e.results.length-1;w++){var v=Math.round(s+u*w),h=Math.round(s+u*(w+1));i.push(Math.log2(e.results[w].count)+1),n.push(v+" to "+h),a.push(v+" to "+h+": "+e.results[w].count+" values")}}catch(e){console.log("No result found"),console.log("error :"+e)}finally{var f={responsive:!0,maintainAspectRatio:!1,scaleBeginAtZero:!0,elements:{center:{text:"90%",color:"#FF6384",fontStyle:"Arial",sidePadding:20}},legend:{display:!1,position:"top",onClick:function(e){e.stopPropagation()}},hover:{mode:"nearest",intersect:!0},title:{display:!0,text:[p,m],position:"bottom"},scales:{xAxes:[{ticks:{beginAtZero:!1,autoSkip:!1,maxRotation:90,minRotation:90}}],yAxes:[{ticks:{beginAtZero:!0,min:0,display:!1}}]},tooltips:{callbacks:{label:function(e,t){return a[e.index]}},custom:function(e){e.opacity||(document.getElementById(g).style.cursor="default")}}};window.geneLengthChartObject=new Chart(t,{type:"bar",data:{labels:n,datasets:[{data:i,backgroundColor:l}]},options:f})}})}$(document).ready(function(){initializeStartupConfiguration()});